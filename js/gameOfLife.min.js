(function(){function h(a,b){return document.getElementById("cell-"+a+"-"+b)}function B(a){return new Promise(b=>setTimeout(b,a))}function y(){!d&&p&&(A(),d||B(e).then(()=>y()))}function A(){const a=[];for(let b=0;b<k+10;b++)for(let c=0;c<l+10;c++)f[b][c].enabled&&(f[b][c].setNextState(),a.push(f[b][c]));v.splice(0,v.length);for(let b of a)b.applyNextState()}function C(){!p&&q&&r&&t&&z&&(p=!0,document.getElementById("start").classList.add("hidden"),document.getElementById("speedUpbtn").classList.remove("hidden"),
document.getElementById("slowDownbtn").classList.remove("hidden"),document.getElementById("pauseBtn").classList.remove("hidden"),document.getElementById("singleStepBtn").classList.remove("hidden"),document.querySelectorAll(".speedBtns").forEach(a=>{a.classList.remove("hidden")}),y())}function D(a){!p&&q&&r&&t&&!z&&(e=Number(m.value),l=Number(w.value),k=Number(x.value),w.disabled=!0,x.disabled=!0,a.target.classList.add("hidden"),m.disabled=!0,document.getElementById("start").disabled=!1,document.getElementById("start").classList.remove("hidden"),
E(),z=!0)}function F(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(q=!0,a=document.getElementById("invalidRows"),"undefined"!=typeof a&&null!=a&&a.remove()):(q&&(a=document.createElement("p"),a.id="invalidRows",a.textContent="Valid range is 1-75 rows",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),q=!1)}function G(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&
0<Number(a.target.value)&&""!==a.target.value?(r=!0,a=document.getElementById("invalidCols"),"undefined"!=typeof a&&null!=a&&a.remove()):(r&&(a=document.createElement("p"),a.id="invalidCols",a.textContent="Valid range is 1-75 columns",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),r=!1)}function H(a){/^\d{0,3}$/.test(a.target.value)&&500>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(t=!0,a=document.getElementById("invalidSpeed"),
"undefined"!=typeof a&&null!=a&&a.remove()):(t&&(a=document.createElement("p"),a.id="invalidSpeed",a.textContent="Valid range is 1-500 whole ms",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),t=!1)}function I(){1<=e-10&&(e-=10,m.value=e)}function J(){500>=e+10&&(e+=10,m.value=e)}function K(){d?(d=!1,document.getElementById("pauseBtn").textContent="Pause",y()):(d=!0,document.getElementById("pauseBtn").textContent="Unpause");
document.getElementById("singleStepBtn").disabled=!d}function E(){for(let a=0;a<k+10;a++){f.push([]);const b=document.createElement("div");b.id="col-"+a;b.classList.add("col");L.appendChild(b);for(let c=0;c<l+10;c++){const n=new M(a,c);f[a].push(n);f[a][c].setNeighbors();if(5<=a&&a<k+5&&5<=c&&c<l+5){const g=document.createElement("div");g.id="cell-"+a+"-"+c;g.classList.add("cell");b.appendChild(g);g.addEventListener("click",()=>n.handleClick())}}}}let p=!1,q=!0,r=!0,t=!0,z=!1,e=200,l=30,k=30,d=!1,
u=!1;const f=[],v=[],L=document.getElementById("gameBoard_UI"),w=document.getElementById("rowsInput"),x=document.getElementById("colsInput"),m=document.getElementById("speedInput");class M{constructor(a,b){this.x=a;this.y=b;this.enabled=this.nextState=this.alive=!1;this.neighbors=[];this.aliveNeighbors=0;this.permaDead=!1}setNeighbors(){const a=[-1,0,1];for(let n of a)for(let g of a){var b=this.x+n,c=this.y+g;!(0<=b&&b<k+10&&0<=c&&c<l+10)||0===n&&0===g||this.neighbors.push([this.x+n,this.y+g])}6>
this.neighbors.length&&(this.permaDead=!0)}handleClick(){p||((this.alive=!this.alive)?(h(this.x,this.y).classList.add("alive"),this.setEnable()):h(this.x,this.y).classList.remove("alive"),this.enabled=!0)}setAliveNeighborCount(){this.aliveNeighbors=0;for(let a of this.neighbors)f[a[0]][a[1]].alive&&this.aliveNeighbors++}setEnable(){for(let a of this.neighbors)f[a[0]][a[1]].enabled=!0}setNextState(){this.setAliveNeighborCount();this.permaDead?this.nextState=!1:!this.alive||2!==this.aliveNeighbors&&
3!==this.aliveNeighbors?this.alive||3!==this.aliveNeighbors?(this.nextState=!1,0===this.aliveNeighbors&&(this.enabled=!1)):this.nextState=!0:this.nextState=!0}applyNextState(){(this.alive=this.nextState)&&this.setEnable();5<=this.x&&this.x<k+5&&5<=this.y&&this.y<l+5&&(h(this.x,this.y).classList.remove("alive"),h(this.x,this.y).classList.remove("enabled"),this.alive?h(this.x,this.y).classList.add("alive"):this.enabled&&(u&&h(this.x,this.y).classList.add("enabled"),v.push(this)))}}(function(){document.getElementById("start").addEventListener("click",
C);document.getElementById("buildGrid").addEventListener("click",D);document.getElementById("speedUpbtn").addEventListener("click",I);document.getElementById("slowDownbtn").addEventListener("click",J);document.getElementById("pauseBtn").addEventListener("click",K);document.getElementById("singleStepBtn").addEventListener("click",()=>{d&&A()});w.addEventListener("input",F);x.addEventListener("input",G);x.value="30";w.value="30";m.value="200";m.addEventListener("input",H);document.getElementById("start").disabled=
!0;document.getElementById("enabledInput").checked=!1;document.getElementById("enabledInput").addEventListener("input",()=>{d&&u&&document.querySelectorAll(".enabled").forEach(a=>{a.classList.remove("enabled")});u=!u;d&&u&&v.forEach(a=>{h(a.x,a.y).classList.add("enabled")})})})()})();
